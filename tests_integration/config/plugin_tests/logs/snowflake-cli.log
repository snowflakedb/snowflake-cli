2025-10-10 09:44:38 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 09:44:38 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 09:44:40 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 09:44:40 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 09:50:55 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 09:50:55 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 09:50:57 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 09:50:57 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:06:04 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:06:04 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:06:04 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:06:04 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:06:09 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:06:11 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:06:13 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:06:13 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:06:15 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:06:15 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:06:50 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:06:50 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:06:52 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:06:52 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:06:54 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:06:54 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:06:56 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:06:56 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:06:58 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:07:01 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:07:09 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:07:09 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:07:10 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:07:10 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:07:14 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:07:14 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:07:16 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:07:16 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:07:18 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:07:20 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:08:25 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:08:25 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:08:27 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:08:27 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:08:29 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:08:32 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:08:34 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:08:34 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:08:36 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:08:36 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:09:09 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:09:09 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:09:11 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:09:11 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:09:13 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:09:15 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:09:18 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:09:18 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:09:21 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:09:21 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:09:37 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:09:40 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:09:42 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:09:42 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:09:44 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:09:44 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:09:47 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:09:47 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:09:47 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:09:47 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:10:24 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:10:26 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:10:28 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:10:28 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:10:30 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:10:30 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:10:33 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:10:33 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:10:35 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:10:35 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:18:18 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:18:20 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:18:20 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:18:22 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:18:22 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:18:33 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:18:33 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:18:35 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:18:35 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:18:37 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:18:37 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:18:39 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:18:39 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:18:41 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:18:43 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:19:35 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:19:37 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:19:40 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:19:40 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:19:42 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:19:42 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:19:45 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:19:45 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:19:47 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:19:47 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:41:06 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:41:06 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:41:08 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:41:08 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:45:18 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:45:18 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:45:21 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:45:21 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:45:23 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:48:13 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:48:13 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:48:15 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:48:15 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:48:17 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:48:17 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:48:20 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:48:20 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:48:22 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:48:24 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:48:47 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:48:47 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:48:49 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:48:49 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:49:01 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:49:01 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:49:04 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:49:04 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:49:17 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
  File "/Users/mraba/sources/snowflake-cli/.hatch/snowflake-cli/lib/python3.10/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/Users/mraba/sources/snowflake-cli/.hatch/snowflake-cli/lib/python3.10/site-packages/importlib_metadata/__init__.py", line 221, in load
    module = import_module(self.module)
  File "/Users/mraba/.pyenv/versions/3.10.18/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/snowflake-cli/lib/python3.10/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/snowflake-cli/lib/python3.10/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:49:19 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
  File "/Users/mraba/sources/snowflake-cli/.hatch/snowflake-cli/lib/python3.10/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/Users/mraba/sources/snowflake-cli/.hatch/snowflake-cli/lib/python3.10/site-packages/importlib_metadata/__init__.py", line 221, in load
    module = import_module(self.module)
  File "/Users/mraba/.pyenv/versions/3.10.18/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/snowflake-cli/lib/python3.10/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/snowflake-cli/lib/python3.10/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:49:22 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:49:22 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:49:24 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:49:24 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:49:26 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:49:26 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:49:27 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:49:27 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:51:50 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:51:50 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:51:52 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:51:52 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:51:54 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:52:10 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:52:13 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 10:52:15 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:52:15 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:52:17 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 10:52:17 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 10:52:20 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:52:20 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 10:52:22 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 10:52:22 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:04:40 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:04:40 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:04:42 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:04:42 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:05:25 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 11:05:27 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 11:05:30 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:05:30 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:05:32 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:05:32 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:05:34 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 11:05:34 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 11:05:36 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 11:05:36 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 11:05:44 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:05:44 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:05:47 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 11:05:49 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 11:05:49 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 11:21:17 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:21:17 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:21:20 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:21:20 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:21:29 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:21:29 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:21:31 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:21:31 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:21:58 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:21:58 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:21:58 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:21:58 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:22:15 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:22:15 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:22:17 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:22:17 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:22:19 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
  File "/Users/mraba/sources/snowflake-cli/.hatch/snowflake-cli/lib/python3.10/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/Users/mraba/sources/snowflake-cli/.hatch/snowflake-cli/lib/python3.10/site-packages/importlib_metadata/__init__.py", line 221, in load
    module = import_module(self.module)
  File "/Users/mraba/.pyenv/versions/3.10.18/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/snowflake-cli/lib/python3.10/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/snowflake-cli/lib/python3.10/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 11:22:21 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
  File "/Users/mraba/sources/snowflake-cli/.hatch/snowflake-cli/lib/python3.10/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/Users/mraba/sources/snowflake-cli/.hatch/snowflake-cli/lib/python3.10/site-packages/importlib_metadata/__init__.py", line 221, in load
    module = import_module(self.module)
  File "/Users/mraba/.pyenv/versions/3.10.18/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/snowflake-cli/lib/python3.10/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/snowflake-cli/lib/python3.10/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 11:22:24 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 11:22:24 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 11:22:26 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 11:22:26 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 11:23:24 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 11:23:24 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 11:23:26 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:23:26 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:23:28 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:23:28 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:23:30 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
  File "/Users/mraba/sources/snowflake-cli/.hatch/snowflake-cli/lib/python3.10/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/Users/mraba/sources/snowflake-cli/.hatch/snowflake-cli/lib/python3.10/site-packages/importlib_metadata/__init__.py", line 221, in load
    module = import_module(self.module)
  File "/Users/mraba/.pyenv/versions/3.10.18/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/snowflake-cli/lib/python3.10/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/snowflake-cli/lib/python3.10/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 11:23:41 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
  File "/Users/mraba/sources/snowflake-cli/.hatch/snowflake-cli/lib/python3.10/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/Users/mraba/sources/snowflake-cli/.hatch/snowflake-cli/lib/python3.10/site-packages/importlib_metadata/__init__.py", line 221, in load
    module = import_module(self.module)
  File "/Users/mraba/.pyenv/versions/3.10.18/lib/python3.10/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1050, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1027, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1006, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 688, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 883, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/snowflake-cli/lib/python3.10/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/snowflake-cli/lib/python3.10/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 11:23:44 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:23:44 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:23:44 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:23:44 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:23:46 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 11:23:46 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 11:28:29 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 11:28:29 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 11:28:31 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 11:28:33 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:28:33 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:28:34 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:28:34 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:32:09 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:32:09 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:32:11 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:32:11 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:32:13 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 11:32:13 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 11:32:15 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 11:32:32 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:32:32 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:32:32 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:32:32 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:32:34 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 11:32:37 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 11:32:37 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 11:33:59 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 11:33:59 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 11:34:01 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:34:01 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:34:04 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:34:04 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:34:06 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 11:34:11 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 11:34:11 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 11:34:13 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 11:34:15 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:34:15 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:34:16 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:34:16 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:36:33 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:36:33 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:36:35 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:36:35 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:36:38 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 11:36:38 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 11:36:40 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 11:37:40 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 11:37:40 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 11:37:42 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:37:42 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:37:42 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:37:42 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:37:44 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 11:37:53 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 11:37:53 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 11:37:55 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 11:37:58 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:37:58 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:38:00 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:38:00 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:38:57 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: broken_plugin
2025-10-10 11:38:57 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [broken_plugin]: Invalid command path [snow broken run]. Command group [broken] does not exist.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 61, in _add_plugin_to_typer
    parent_group = self._find_typer_group_at_path(
        current_level_group=self._main_typer_command_group,
        remaining_parent_path_segments=command_spec.parent_command_path.path_segments,
        command_spec=command_spec,
    )
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 144, in _find_typer_group_at_path
    raise RuntimeError(
    ...<2 lines>...
    )
RuntimeError: Invalid command path [snow broken run]. Command group [broken] does not exist.
2025-10-10 11:39:00 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:39:00 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:39:02 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:39:02 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
    ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
        f"Cannot add command [{command_spec.full_command_path}] because it already exists."
    )
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:39:04 ERROR [snowflake.cli._app.commands_registration.command_plugins_loader] Cannot register plugin [failing_plugin]: Some error in plugin
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/command_plugins_loader.py", line 63, in register_external_plugins
    self._plugin_manager.load_setuptools_entrypoints(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        SNOWCLI_COMMAND_PLUGIN_NAMESPACE, plugin_name
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/pluggy/_manager.py", line 416, in load_setuptools_entrypoints
    plugin = ep.load()
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/metadata/__init__.py", line 179, in load
    module = import_module(match.group('module'))
  File "/opt/homebrew/Cellar/python@3.13/3.13.7/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/plugin_spec.py", line 21, in <module>
    from snowflakecli.test_plugins.failing_plugin import commands
  File "/Users/mraba/sources/snowflake-cli/.hatch/integration/lib/python3.13/site-packages/snowflakecli/test_plugins/failing_plugin/commands.py", line 19, in <module>
    raise RuntimeError("Some error in plugin")
RuntimeError: Some error in plugin
2025-10-10 11:40:05 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:40:05 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
RuntimeError: Cannot add command [snow connection list] because it already exists.
2025-10-10 11:40:07 INFO [snowflake.cli._app.commands_registration.command_plugins_loader] Loaded external plugin: override
2025-10-10 11:40:07 ERROR [snowflake.cli._app.commands_registration.typer_registration] Cannot register plugin [override]: Cannot add command [snow connection list] because it already exists.
Traceback (most recent call last):
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 40, in register_commands
    self._add_plugin_to_typer(plugin.command_spec)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 66, in _add_plugin_to_typer
    self._validate_command_spec(command_spec, parent_group)
  File "/Users/mraba/sources/snowflake-cli/src/snowflake/cli/_app/commands_registration/typer_registration.py", line 106, in _validate_command_spec
    raise RuntimeError(
RuntimeError: Cannot add command [snow connection list] because it already exists.
